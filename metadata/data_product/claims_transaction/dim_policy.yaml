target:
  lakehouse: den_lhw_dpr_001_claims_transaction
  schema: claims_transaction
  table: dim_policy
  load_strategy: type_two
  key_columns:
    - policy_num_bus_key
  unknown_record: True
  identity: True
  identity_column_name: policy_key

source:
  - name: curated_claimant
    lakehouse: den_lhw_scu_001_claims_transaction_curated
    schema: iis_transaction
    table: claimant

query:
  - name: dim_policy
    sql: |
      SELECT DISTINCT
        code AS policy_num_bus_key
      FROM curated_claimant
      WHERE dl_iscurrent = 1
    description: "This query selects unique policy numbers from the curated_claimant source table."
    