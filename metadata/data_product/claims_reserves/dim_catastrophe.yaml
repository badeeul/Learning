target:
  lakehouse: den_lhw_dpr_001_data_product_tables
  schema: reserves
  table: dim_catastrophe
  load_strategy: type_two
  key_columns:
    - catastrophe_code
  unknown_record: True
  identity: True

source:
  - name: curated_bop_claim_summary
    lakehouse: den_lhw_dpr_001_data_product_tables
    schema: reserves
    table: BOPClaimSummary

  - name: curated_ca_claim_summary
    lakehouse: den_lhw_dpr_001_data_product_tables
    schema: reserves
    table: CAClaimSummary

  - name: curated_db_claim_summary
    lakehouse: den_lhw_dpr_001_data_product_tables
    schema: reserves
    table: DBClaimSummary

  - name: curated_ho_claim_summary
    lakehouse: den_lhw_dpr_001_data_product_tables
    schema: reserves
    table: HOClaimSummary

  - name: curated_wc_claim_summary
    lakehouse: den_lhw_dpr_001_data_product_tables
    schema: reserves
    table: WCClaimSummary

query:
  - name: dim_catastrophe
    sql: SELECT 
            cast(catcode as int) as catastrophe_code
            ,cast(null as string) as catastrophe_perils
            ,cast(null as string) as catastrophe_effective_year
            ,cast(null as timestamp) as catastrophe_from_date
            ,cast(null as timestamp) as catastrophe_to_date
        FROM 
            curated_bop_claim_summary
        GROUP BY
            catcode
        UNION
        SELECT 
            cast(catcode as int) as catastrophe_code
            ,cast(null as string) as catastrophe_perils
            ,cast(null as string) as catastrophe_effective_year
            ,cast(null as timestamp) as catastrophe_from_date
            ,cast(null as timestamp) as catastrophe_to_date
        FROM
            curated_ca_claim_summary
        GROUP BY
            catcode
        UNION
        SELECT 
            cast(catcode as int) as catastrophe_code
            ,cast(null as string) as catastrophe_perils
            ,cast(null as string) as catastrophe_effective_year
            ,cast(null as timestamp) as catastrophe_from_date
            ,cast(null as timestamp) as catastrophe_to_date
        FROM
            curated_db_claim_summary
        GROUP BY
            catcode
        UNION
        SELECT 
            cast(catcode as int) as catastrophe_code
            ,cast(null as string) as catastrophe_perils
            ,cast(null as string) as catastrophe_effective_year
            ,cast(null as timestamp) as catastrophe_from_date
            ,cast(null as timestamp) as catastrophe_to_date
        FROM
            curated_ho_claim_summary
        GROUP BY
            catcode
        UNION
        SELECT 
            cast(catcode as int) as catastrophe_code
            ,cast(null as string) as catastrophe_perils
            ,cast(null as string) as catastrophe_effective_year
            ,cast(null as timestamp) as catastrophe_from_date
            ,cast(null as timestamp) as catastrophe_to_date
        FROM
            curated_wc_claim_summary
        GROUP BY
            catcode
    description: |
      This query creates a dimension table for catastrophe codes by selecting distinct values from the curated claim summary tables. 
      The columns for catastrophe_perils, catastrophe_effective_year, catastrophe_from_date, and catastrophe_to_date are cast to null as placeholders.
