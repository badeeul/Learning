target:
  lakehouse: den_lhw_dpr_001_data_product_tables
  schema: reserves
  table: dim_line_of_business
  load_strategy: type_two
  key_columns:
    - line_of_business_code
  unknown_record: True
  identity: True

source:
  - name: curated_bop_claim_summary
    lakehouse: den_lhw_dpr_001_data_product_tables
    schema: reserves
    table: BOPClaimSummary

  - name: curated_ca_claim_summary
    lakehouse: den_lhw_dpr_001_data_product_tables
    schema: reserves
    table: CAClaimSummary

  - name: curated_db_claim_summary
    lakehouse: den_lhw_dpr_001_data_product_tables
    schema: reserves
    table: DBClaimSummary

  - name: curated_ho_claim_summary
    lakehouse: den_lhw_dpr_001_data_product_tables
    schema: reserves
    table: HOClaimSummary

  - name: curated_wc_claim_summary
    lakehouse: den_lhw_dpr_001_data_product_tables
    schema: reserves
    table: WCClaimSummary

query:
  - name: dim_line_of_business
    sql: SELECT 
            lob as line_of_business_code
            ,cast(null as string) as line_of_business_name
            ,cast(null as string) as line_of_business_description
            ,cast(null as string) as line_of_business_group
        FROM curated_bop_claim_summary
        GROUP BY
            lob
        UNION
        SELECT 
            lob as line_of_business_code
            ,cast(null as string) as line_of_business_name
            ,cast(null as string) as line_of_business_description
            ,cast(null as string) as line_of_business_group
        FROM curated_ca_claim_summary
        GROUP BY
            lob
        UNION
        SELECT 
            lob as line_of_business_code
            ,cast(null as string) as line_of_business_name
            ,cast(null as string) as line_of_business_description
            ,cast(null as string) as line_of_business_group
        FROM curated_db_claim_summary
        GROUP BY
            lob    
        UNION
        SELECT 
            lob as line_of_business_code
            ,cast(null as string) as line_of_business_name
            ,cast(null as string) as line_of_business_description
            ,cast(null as string) as line_of_business_group
        FROM curated_ho_claim_summary
        GROUP BY
            lob
        UNION
        SELECT 
            lob as line_of_business_code
            ,cast(null as string) as line_of_business_name
            ,cast(null as string) as line_of_business_description
            ,cast(null as string) as line_of_business_group
        FROM curated_wc_claim_summary
        GROUP BY
            lob
    description: |
      This table is used to create a dimension table for line of business. The table is created by 
      unioning the line of business codes from the curated claim summary tables for BOP, CA, HO, DB, and WC.
