target:
  lakehouse: den_lhw_dpr_001_data_product_tables
  schema: reserves
  table: dim_auto_secondary_class
  load_strategy: type_two
  key_columns:
    - auto_secondary_class_code
  unknown_record: True
  identity: True

source:
  - name: curated_ca_claim_summary
    lakehouse: den_lhw_dpr_001_data_product_tables
    schema: reserves
    table: CAClaimSummary

query:
  - name: dim_auto_secondary_class
    sql: SELECT DISTINCT
            autosecondaryclass as auto_secondary_class_code
        FROM curated_ca_claim_summary
    description: |
      This table is used to create a dimension table for auto auto secondary class. The table is created
      from the auto secondary class codes of the curated claim summary table for CA only.
